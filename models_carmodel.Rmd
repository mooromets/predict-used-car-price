---
title: "Model choosing for a car model prediction"
author: "sergey"
date: "March 7, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(randomForest)
library(caret)
```

```{r prepare volkswagen data, warning = FALSE, message=FALSE}
source("./data-clean.R")
source("./ML_utils.R")
vw <- getBrandDataset(clean_auto, "volkswagen")
# number of models to predict:
length(unlist(unique(vw[, "model"])))
```
## datasets
``` {r vw datasets }
#small dataset
dataset <- vw[sample(nrow(vw), size = 1000), ]


inTrain <- createDataPartition(y = dataset$model, p=0.75, list=FALSE)
training <- dataset[inTrain, ]
testing <- dataset[-inTrain, ]
#dim(training)
```
``` {r prepare}
seed <- 798
metric <- "Accuracy"
control <- trainControl(method="repeatedcv", number=5, repeats=3)
```


## learning 
``` {r learning}
modFit <- train(model ~ ., method = "rpart", metric = metric, data = dataset, trControl = control)
results <- resamples(list(
    rpart = modFit
  ))
```

## plot
``` {r figures}
# boxplot comparison
bwplot(results)
# Dot-plot comparison
dotplot(results)
```

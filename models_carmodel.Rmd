---
title: "Model choosing for a car model prediction"
author: "sergey"
date: "March 7, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(randomForest)
library(caret)
```

```{r prepare volkswagen data, warning = FALSE, message=FALSE}
source("./data-clean.R")
source("./ML_utils.R")
vw <- getBrandDataset(clean_auto, "volkswagen")
# number of models to predict:
length(unlist(unique(vw[, "model"])))
```
``` {r prepare}
#small dataset
dataset <- vw[sample(nrow(vw), size = 4000), ]

#setup
seed <- 798
metric <- "Accuracy"
control <- trainControl(method="cv", number=4)
```


## learning 
``` {r learning}
results <- resamples(
  sapply(X = list("rpart", "rf", "C5.0", "treebag", "J48", "PART"),
         FUN = defModelFit,
         seed = seed,
         form = model ~ .,
         data = dataset,
         metric = metric,
         trControl = control,
         simplify = FALSE,
         USE.NAMES = TRUE))
summary(results)
```

## plot
``` {r figures}
# boxplot comparison
bwplot(results)
# Dot-plot comparison
dotplot(results)
```
